{% extends 'main/shop.html' %}
{% load static %}
{% block title %} Add a product to the shop | ShopSite {% endblock %} 
{% block specific_script %}
<style>
      .inner {
      overflow: hidden;
      border-radius: 8px;
      padding-top: 0px;
      box-shadow: 0 0 8px gray;
    }
  
    input[type="file"] {
      font-style: italic;
    }
  


    label{
        font-style:italic;
        margin-bottom: 1px;  
        margin-right:50px;
    }
    input[type="file"]{
        font-style: italic;
    }
    #description{
        height: 150px;
    }

    [class*="btn"]{
  border-radius: 20px;
  width:75px;
}

[class*="sidebar-btn"]{
    border-radius:50%;
    width: 33px;
    padding:7px 7px 7px 7px;
    display:flex; 
    justify-content:center; 
    align-items:center;
  }
  /* @media(min-width:500px){
    .mobile-only-row{
      display:none;
      border:2px solid green;
    }
  } */

.target-location{
  display:grid;
  justify-content: center;
  /* border:1px solid indigo; */
  grid-template-columns:repeat(auto-fill, 190px);
  grid-auto-rows:200px;
  gap:1rem;
  
}

.camera_icon{
  border-radius:8px; 
  box-shadow:0 0 3px black;
  height: 200px;
  transform:scale(0.85);
  background-position: center;
  background-size: cover;
}

.mother .row{
  display:flex; 
  justify-content:center;
}

#image1::after{
content:'*'; 
color:red;
}

.new-div{
  display:flex;
  flex-direction: row;
}

.detail-input{
  margin:5px;
}

</style>
{% endblock %} 
{% block content %}
<div class="container">
  <div class="row big-row">
    <h1 class="h2 border-bottom pt-1 pb-3">
      <span>Add</span>
      <span class="text-danger"> product</span>
    </h1>
  </div>
</div>

<div class="big-container">
  <div id="main-container">
    <div class="container-fluid">
      
      <div class="row">
       
        <form action="" method="POST" enctype="multipart/form-data">
          {% csrf_token %}
          <div class="row">
            <div class="col-lg-12 mother">

              <div class="row mb-2" >
                <div class="col-lg-1">
                  <label class="text-nowrap">Name:</label>
                </div>
                <div class="col-lg-7">
                  {{form.name}}
                </div>

                
              </div>

              <div class="row mb-2">
                <div class="col-lg-1">
                  <label class="text-nowrap">Price:</label>
                </div>
                <div class="col-lg-7">
                  {{form.price}}
                </div>
              </div>
              <div class="row mb-2">
                <div class="col-lg-1">
                  <label class="text-nowrap">Description:</label>
                </div>
                <div class="col-lg-7">
                  {{form.description}}
                </div>
              </div>
              <div class="row mb-2">
                <div class="col-lg-1">
                  <label class="text-nowrap">Stock:</label>
                </div>
                <div class="col-lg-7">
                  {{form.stock}}
                </div>
              </div>

              <div class="row mb-2 mobile-only-row">
                <div class="col-lg-1">
                  <label class="text-nowrap" id="image1">Image 1:</label>
                </div>
                <div class="col-lg-7">
                  {{form.image}}
                </div>
              </div>


              <div class="row mobile-only-row">
                <div class="col-lg-1">
                  <label class="text-nowrap">Note:</label>
                </div>
                <div class="col-lg-7">
                  <p style="font-style:italic" class="text-danger">'Image 1' will be used as the product image in the shop, the remaining images appear in the product preview section</p>
                </div>
              </div>

              <div class="row mb-2 mobile-only-row">
                <div class="col-lg-1">
                  <label class="text-nowrap">Image 2:</label>
                </div>
                <div class="col-lg-7">
                  {{form.image_2}}
                </div>
              </div>

              <div class="row mb-2 mobile-only-row">
                <div class="col-lg-1">
                  <label class="text-nowrap">Image 3:</label>
                </div>
                <div class="col-lg-7">
                  {{form.image_3}}
                </div>
              </div>


              <div class="row mb-2 mobile-only-row">
                <div class="col-lg-1">
                  <label class="text-nowrap">Image 4:</label>
                </div>
                <div class="col-lg-7">
                  {{form.image_4}}
                </div>
              </div>



              <div class="row mb-2 mobile-only-row">
                <div class="col-lg-1">
                  <label class="text-nowrap">Image 5:</label>
                </div>
                <div class="col-lg-7">
                  {{form.image_5}}
                </div>
              </div>



              <div class="row mb-2 mobile-only-row">
                <div class="col-lg-1">
                  <label class="text-nowrap">Image 6:</label>
                </div>
                <div class="col-lg-7">
                  {{form.image_6}}
                </div>
              </div>

              <div class="row mb-2 ">
                <div class="target-location col-lg-8 mt-2">
                  <div class="camera_icon"  id="1"></div>
                  <div class="camera_icon"  id="2"></div>
                  <div class="camera_icon"  id="3"></div>
                  <div class="camera_icon"  id="4"></div>
                  <div class="camera_icon"  id="5"></div>
                  <div class="camera_icon"  id="6"></div>
                </div>

              </div>


              
              
              <!-- below here -->
              <h4 class="h4 border-bottom pt-1 pb-3">
              <span>Product</span>
              <span class="text-danger"> Details</span> <span><small>(Optional)</small></span>
            </h4>
            <div class="btn btn-success" id="add-detail" onclick="add_detail_field_pair()">Add+</div>

            <div id="detail-container">
              <input type="hidden" value="5" name="n" id="current_count_input">

              <div class="new-div">
                <input class="form-control detail-input" name="det_1" type="text"  placeholder="Detail">
                <input class="form-control detail-input" name="val_1" type="text"  placeholder="Value">
              </div>
              <div class="new-div">
                <input class="form-control detail-input" name="det_2" type="text"  placeholder="Detail">
                <input class="form-control detail-input" name="val_2" type="text"  placeholder="Value">
              </div>
              <div class="new-div">
                <input class="form-control detail-input" name="det_3" type="text"  placeholder="Detail">
                <input class="form-control detail-input" name="val_3" type="text"  placeholder="Value">
              </div>
              <div class="new-div">
                <input class="form-control detail-input" name="det_4" type="text"  placeholder="Detail">
                <input class="form-control detail-input" name="val_4" type="text"  placeholder="Value">
              </div>
              <div class="new-div">
                <input class="form-control detail-input" name="det_5" type="text"  placeholder="Detail">
                <input class="form-control detail-input" name="val_5" type="text"  placeholder="Value">
              </div>
              
            </div>
            <div class="row mb-2">
              <div class="col-lg-8 col-md-1" style="text-align: center;margin-top: 2em;">
                <input type="submit" class="btn btn-outline-success" value="Save" name="" id="">
              </div>
            </div>
            
          </div>
    
           
          </div>

          
    
        </form>  
    


        
      </div>



    </div>
   </div>                  
</div>
          

  <script src="{% static 'js/jquery-3.6.1.js' %}"></script>
  <script src="{% static 'js/jquery.min.js' %}"></script>
  <script>
    $('.camera_icon').hide();

    const add_detail = document.getElementById('add-detail');
    const detail_container = document.getElementById('detail-container');
    const current_count_input = document.getElementById('current_count_input');

    function preview_image(event, id, self) {
      var reader = new FileReader();
      reader.onload = function () {
        var output = document.getElementById(`${id}`);
        // output.style.display = 'block'
        // image = output.firstElementChild;
        $(`#${id}`).show(300)
        output.style.backgroundImage = "url('" + reader.result + "')";

        console.log(output);
      };
      reader.readAsDataURL(event.target.files[0]);
    }

    function add_detail_field_pair(event) {
      detail_input = document.createElement('input');
      value_input = document.createElement('input');
      new_div = document.createElement('div');
      new_div.setAttribute('class', 'new-div')
      var current_count = document.querySelectorAll('.detail-input').length / 2

      // Set attributes for the detail field
      detail_input.setAttribute('class', 'form-control detail-input');
      detail_input.setAttribute('placeholder', 'Detail');
      detail_input.setAttribute('name', `det_${current_count+1}`)

      // Set attributes for the corresponding value field
      value_input.setAttribute('class', 'form-control detail-input');
      value_input.setAttribute('placeholder', 'Value');
      value_input.setAttribute('name', `val_${current_count+1}`)

      // Append to the div, then to the document
      new_div.append(detail_input);
      new_div.append(value_input);
      detail_container.append(new_div)

      // Update the total count field
      current_count_input.value = document.querySelectorAll('.detail-input').length / 2
    }


  </script>
</div>
</div>
<!-- SIDE NAV SECTION -->
<nav id="test_div">
  <div class="side-icon-container">
    <a class="btn btn-outline-primary sidebar-btn mb-2" href="{% url 'shop' shop.owner.username shop.name %}">
      <i class="fa fa-store"></i>
    </a>
    <a class="btn btn-outline-primary sidebar-btn mb-2" href="{% url 'my_shops' request.user.username %}">
      <i class="fa fa-shop"></i>
    </a>
    <a class="btn btn-outline-primary sidebar-btn mb-2" href="{% url 'all_shops' %}">
      <i class="fa fa-search"></i>
    </a>
  </div>
</nav>
<!-- BOTTOM NAV ICONS -->
<nav class="bottom-nav">
  <div class="bottom-nav-icons">
    <a class="btn btn-outline-primary sidebar-btn mb-2" href="{% url 'shop' shop.owner.username shop.name %}">
      <i class="fa fa-store"></i>
    </a>
    <a class="btn btn-outline-primary sidebar-btn mb-2" href="{% url 'my_shops' request.user.username %}">
      <i class="fa fa-shop"></i>
    </a>
    <a class="btn btn-outline-primary sidebar-btn mb-2" href="{% url 'all_shops' %}">
      <i class="fa fa-search"></i>
    </a>
  </div>
</nav>

{% endblock %}


