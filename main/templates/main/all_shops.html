{% extends 'main/base.html' %} 
{% block specific_script %}
<style>
.new-row{
  display:grid;
  justify-content: space-around;
  grid-template-columns: repeat(auto-fill, 150px);
  column-gap: 1rem;
  row-gap: 0.5rem;
}



.shop-container{
  display:flex; 
  flex-direction: column;
  text-align:center;
  padding:7px; 
  margin-right:15px; 
  overflow-x:hidden;
  border-radius: 20px;
  transform:scale(0.9);
}

.shop-container a {
  text-decoration: none;
}



.card:hover{
  box-shadow: 0 0 4px  rgb(22, 24, 170);
}


::placeholder{
  text-transform: none;
}

[class*="btn"]{
  border-radius: 20px;
  width:75px;
}
input[type="search"], input[type="search"]:focus{
  text-transform: uppercase;
  background-color: transparent;
}

a{
  text-decoration:none;
}
[class*="sidebar-btn"]{
    border-radius:50%;
    width: 33px;
    padding:7px 7px 7px 7px;
    display:flex; 
    justify-content:center; 
    align-items:center;
  }

.test-shop-container{
  position:relative;
  display:flex;
  flex-direction:column;
  border-radius:8px;
  box-shadow: 0 0 3px gray;
  
}


/* .shop-image-section{
  flex:1; 
} */


/* .image-item{
  
  position:relative;
} */

/* .image-item::after, .image-item::before{
  content:''; 
  width:100%; 
  height: 10px;
  position:absolute;
  bottom:0px; 
  right:0px; 
  background-color:transparent; 

}

.image-item::after{
  border-top-right-radius: 10px;
  background-color:white;
  
} */



.shop-image-section img{
   width:100%;
   height:110px;
   object-fit:cover;
   border-radius:8px 8px 4px 4px;
   box-shadow:0 0 2px black;
}



.shop-image-section{
  /* outline:1px solid black; */
  padding:2px;
}
.shop-info-section{
  display:flex; 
  flex-direction:column; 
  justify-content: center;
  align-items:center;
}
</style>
{% endblock %}

{% block content %}
<div class="container">
  <div class="row">
    <h1 class="h2 border-bottom pt-1 pb-3">
      <span>All</span><span class="text-danger"> Shops</span>
    </h1>
  </div>
</div>

<div class="big-container">
<div id="main-container">
  <div class="container-fluid">

    <div class="row">
      <form method="GET" action="" id="my-form" class="d-flex" role="search">
        <input name="q" maxlength="30" class="form-control me-2" type="search" placeholder="Search for shops..." aria-label="Search"/>
          <button class="btn btn-outline-success" style="margin-left: 5px" type="submit">Search</button>       
      </form>              
    </div>

    <div class="row">
      <div class="col column">
          {% if messages %}
      <ul>
        {% for message in messages %}
        <h4 class="mt-4 text-muted" style="font-style:italic;">{{message}}</h4>
        {% endfor %}
      </ul>
      {% endif %}
      </div>
    </div>
  
    
  
  <div class="new-row mt-3">
    {% for shop in shops %}
      <!-- temporary if-else statement to test new updates  -->
        {% if shop.picture %}
        <a href="{% url 'shop' shop.owner.username shop.name %}">
          <div class="test-shop-container card  mb-2">
          <div class="shop-image-section">
            <div class="image-item">
              <img src="{{shop.picture.url}}" alt="" class="shop_image">
            </div>
            
            
          </div>
          <div class="shop-info-section">
            <div class="card-item h6 text-primary" style="text-align:center;font-style:italic; padding:10px;">{{shop.name}}</div>
            <!-- <div class="card-item"><a href="{% url 'shop' shop.owner.username shop.name %}"><button class="btn btn-outline-success btn-sm mb-2"  >view</button></a></div>           -->
            
          </div>
        
        
        <!-- <span class="badge rounded-pill"  style="font-style:italic;position:absolute; top:-7px; right:-20px; box-shadow: 0 0 3px gray;background-color: rgb(35, 35, 216);">shop</span> -->
    </div>
    </a>
        
        {% else %}
        <!-- <div class="shop-container card  mb-2">
          <h5><a class="text-primary text-nowrap" id="text-nowrap">{{shop.name}}</a></h3>
          <p style="font-style:italic;" class="border-bottom">Created on {{shop.date_created}}</p>
          <p style="font-style:italic;" class="border-bottom">owner: {{shop.owner.username}}</p>
          <a href="{% url 'shop' shop.owner.username shop.name %}"><button class="btn btn-outline-success btn-sm" >View</button></a>
      </div> -->
        {% endif %}

        
      {% endfor %}
    </div>
    
  </div>
 
</div>
</div>
  
</div>

<nav class="bottom-nav">
  <div class="bottom-nav-icons">
    {% if request.user.is_authenticated %}<a class="btn btn-outline-primary sidebar-btn mb-2" href="{% url 'my_shops' request.user.username %}"><i class="fa fa-shop"></i></a>{% endif %}
    <a class="btn btn-outline-primary sidebar-btn mb-2"  href="{% url 'all_shops' %}"><i class="fa fa-search"></i></a>
  </div>
</nav>


<nav id="test_div">
  <div class="side-icon-container">
    {% if request.user.is_authenticated %}<a class="btn btn-outline-primary sidebar-btn mb-2" href="{% url 'my_shops' request.user.username %}"><i class="fa fa-shop"></i></a>{% endif %}
    <a class="btn btn-outline-primary sidebar-btn mb-2"  href="{% url 'all_shops' %}"><i class="fa fa-search"></i></a>
  </div>
</nav>


<script>
let shop_names = document.getElementsByClassName('text-primary text-nowrap');
for(const shop_name of shop_names){
  if(shop_name.innerHTML.length > 15){
    shop_name.innerHTML = shop_name.innerHTML.slice(0,16) + '...';
  }
}   
</script>

{% endblock %}
